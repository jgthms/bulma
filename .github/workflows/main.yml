name: End-to-end tests
on: [push]
jobs:
  # sass-build:
  #   runs-on: ubuntu-latest
  #   steps:
  #     - uses: actions/checkout@v3
  #     - uses: ruby/setup-ruby@v1
  #     - name: Install ruby dependencies
  #       run: gem install sass
  #     - name: Ruby sass run
  #       run: test/ruby-sass/ruby-sass.sh
  #     - uses: actions/setup-node@v3
  #     - name: Install dart-sass dependencies
  #       run: npm install sass
  #     - name: Build sass with dart-sass
  #       run: node test/dart-sass/dart-sass.js
  #     - name: Install node-sass dependencies
  #       run: npm install node-sass
  #     - name: Build sass with node-sass
  #       run: node test/node-sass/node-sass.js
  sass-and-cypress-runs:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - uses: actions/setup-node@v3
      - uses: ruby/setup-ruby@v1
        with:
          ruby-version: 2.7
      - name: Install dependencies
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          gem install sass jekyll bundler
          npm install sass node-sass
      - name: Ruby sass run
        run: test/ruby-sass/ruby-sass.sh
      - name: Dart sass run
        run: node test/dart-sass/dart-sass.js
      - name: Node sass run
        run: node test/node-sass/node-sass.js
      - name: Cypress run
        uses: cypress-io/github-action@v4
        with:
          working-directory: docs
          install-command: npm install
          build: npm run bulma-sass
          start: jekyll serve --host 127.0.0.1 --port 4000
          wait-on: "http://127.0.0.1:4000"
